1. Используется I2C1 и I2C3. Настройки по-умолчанию. Slave адрес 20. Проверьте Pull-up. Проверьте скорость GPIO. Эти два параметра могут ограничивать максимальную скорость I2C.
2. Каждое устройство может выступать как в роли Master, так и Slave.
3. Программа: в блоке I2C3 в режиме Slave ожидаем прием 10 байтов по прерыванию от блока I2C1 -> в блоке I2C1 в режиме Master передаем 10 байт по прерыванию по адресу 40 (20 << 1) (это блок I2C1) -> ждем 2 мс -> вызывается Callback HAL_I2C_MasterTxCpltCallback() -> вызывается Callback HAL_I2C_SlaveRxCpltCallback(), в котором передаем из блока I2C3 в режиме Slave 10 байт -> в блоке I2C1 в режиме Master ожидаем прием 10 байтов по прерыванию от блока I2C3 -> вызывается Callback HAL_I2C_SlaveTxCpltCallback() -> вызывается Callback HAL_I2C_MasterRxCpltCallback()