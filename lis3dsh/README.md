# Акселерометр LIS3DSH
## Принцип работы
Акселерометр относится к типу так называемых MEMS (МЭМС) датчиков - микроэлектромеханических систем, принцип работы которых заключается в преобразовании физических воздействий в электрические сигналы (например, ультразвуковой дальномер) или наоборот, электрические сигналы в физические явления (сервомашинка).

![Image alt](https://github.com/nekida/stm32f4-discovery/blob/master/lis3dsh/pic/mems-accelerometer-1.jpg)

Принцип работы акселерометра сводится к следующему: внутри находится подвижный элемент (якорь), представляющий собой одну из обкладок конденсатора, и неподвижная часть, являющася второй обкладкой. Под действием силы тяжести элемент смещается в определенную сторону, меняя расстояние между обкладками конденсатора, тем самым меняя ёмкость, что в свою очередь приводит к изменению напряжения. Теперь можно рассчитать смещение подвижного элемента, а зная его массу и параметры элемента - найти и его ускорение.

![Image alt](https://github.com/nekida/stm32f4-discovery/blob/master/lis3dsh/pic/mems-accelerometer-2-big.jpg)

## Основное из Datasheet'а
Акселерометр может работать по двум интерфейсам: SPI и I2C. 

Диапазон измерений: 
| Значение битов в  регистре  |     Значение        | Единица измерения |
|:---------------------------:|:-------------------:|:-----------------:|
|       000                   |       ±2.0          |                   |
|       001                   |       ±4.0          |                   |
|       010                   |       ±6.0          |       g           |
|       011                   |       ±8.0          |                   |
|       100                   |      ±16.0          |                   |

Пределы измерений ускорения свободного падения - регистр CTRL_REG5 (биты FSCALE). 0xFFFF - это 2 g, 0x0000 - это -2 g. В зависимости от выбранной шкалы - выбирается чувствительность. Так же в CTRL_REG5 можно настроить SPI (3 или 4 провода) (бит SIM), частоту фильтра для подавления дребезга (биты BW) и включить самопроверку акселерометра (биты ST).

Чувствительность:
| Значение битов в  регистре  |     Значение        | Единица измерения |
|:---------------------------:|:-------------------:|:-----------------:|
|       000                   |       0.06          |                   |
|       001                   |       0.12          |                   |
|       010                   |       0.18          |     mg/digit      |
|       011                   |       0.24          |                   |
|       100                   |       0.73          |                   |

При обращении к регистру WHO_AM_I, датчик выдаст значение 0x3F, что является идентифицирующей информацией о наличии на шине именно акселерометра LIS3DSH и корректной работе SPI.
В регистре CTRL_REG4 можно настроить скорость выходных данных и выключить устройство (биты ODR), включить/выключить каждую из осей XYZ (Xen, Yen, Zen). Бит BDU запрещает обновления выходных регистров, пока не будут прочитаны оба значения из двух регистров (значение по каждой оси лежит в 2-х 8 разрядных регистрах как части High и Low).

## Описание библиотеки
Инициализация акселерометра происходит путем передачи в функцию LIS3DSH_init() хэндла используемого модуля SPI, порта и ножки для CS. Информационный обмен предтсавляет собой обычный 4-х проводной интерфейс: MOSI, MISO, SCK, CS. Перед отправкой адреса регистра, из которого нужно читать данные, CS выставляется в 0. Акселерометр инициализирован параметрами со значениями: 
| Значение битов в  регистре    |     Значение   | 
|:------------------------------|:--------------:|
|Output data rate               |100 Hz          |
|BDU                            |0               |
|X-axis                         |enabled         |
|Y-axis                         |enabled         |
|Z-axis                         |disabled        |
|Anti-aliasing filter bandwidth |800 Hz         |
|Full-scale  selection          |±2.0 g          |
|Self-test                      |disabled        |
|SPI mode                       |4-wire interface|

![Image alt](https://github.com/nekida/stm32f4-discovery/blob/master/lis3dsh/pic/Mems_LIS3DSH_connecting.jpg)

Данные по трем осям XYZ возвращаются в функции LIS3DSH_get_XYZ_int16() в формате структуры strct_xyz_int_16, которая представляет собой обычную структуру с полями, содержащими данные по осям: strct_xyz_int_16.x, strct_xyz_int_16.y, strct_xyz_int_16.z.

# Примечание
doc_by_Doxygen.zip - архив с html документацией
